<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Roboto', sans-serif;
        background-color: #f4f4f4;
        display: flex; justify-content: center; align-items: center;
        height: 100vh; margin: 0;
        /* GANTI BACKGROUND: */
        background-image: url('https://images.unsplash.com/photo-1547394765-185e1e68f34e?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
        background-size: cover;
      }
      .card {
        background: white; padding: 30px; border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        width: 90%; max-width: 400px;
        text-align: center;
        border-top: 5px solid #D32F2F;
      }
      h2 { margin-top: 0; color: #D32F2F; }
      input {
        width: 100%; padding: 12px; margin: 15px 0;
        border: 2px solid #ddd; border-radius: 5px; box-sizing: border-box;
        text-align: center; font-size: 16px;
      }
      button {
        width: 100%; padding: 12px; background: #D32F2F; color: white;
        border: none; border-radius: 5px; font-weight: bold; cursor: pointer;
        font-size: 16px;
      }
      button:hover { background: #b71c1c; }
      
      .result { margin-top: 20px; text-align: left; display: none; }
      .box {
        background: #f9f9f9; padding: 10px; margin-bottom: 10px;
        border-radius: 5px; border-left: 4px solid #ccc;
      }
      .box.main { border-left-color: #D32F2F; background: #fff5f5; }
      .label { font-size: 11px; color: #666; display: block; }
      .value { font-size: 18px; font-weight: bold; color: #333; }
    </style>
  </head>
  <body>
    <div class="card">
      <h2>Portal Cuti</h2>
      <p>Masukkan PrivyID Anda</p>
      
      <input type="text" id="inputId" placeholder="Contoh: PV001">
      <button onclick="cari()">CEK SISA CUTI</button>
      
      <div id="loading" style="display:none; margin-top:10px;">Mencari data...</div>

      <div id="hasil" class="result">
        <hr>
        <h3 id="rNama" style="text-align:center;">Nama Karyawan</h3>
        
        <div class="box">
          <span class="label">Total Kuota (Thn + Bonus)</span>
          <span class="value" id="rTotal">0</span>
        </div>
        
        <div class="box">
          <span class="label">Sudah Digunakan</span>
          <span class="value" id="rPakai">0</span>
        </div>

        <div class="box main">
          <span class="label">SISA CUTI SAAT INI</span>
          <span class="value" id="rSisa" style="font-size: 24px;">0</span>
        </div>

        <div class="box">
          <span class="label">Izin / Sakit Bulan Ini</span>
          <span class="value" id="rSakit">0</span>
        </div>
      </div>
    </div>

    <script>
      // Fitur Enter
      document.getElementById("inputId").addEventListener("keypress", function(e) {
        if (e.key === "Enter") cari();
      });

      function cari() {
        var id = document.getElementById("inputId").value;
        if(!id) return alert("Masukkan ID dulu!");

        document.getElementById("loading").style.display = "block";
        document.getElementById("hasil").style.display = "none";

        google.script.run.withSuccessHandler(function(data) {
          document.getElementById("loading").style.display = "none";
          if (data.found) {
            document.getElementById("hasil").style.display = "block";
            document.getElementById("rNama").innerText = data.nama;
            document.getElementById("rTotal").innerText = data.total;
            document.getElementById("rPakai").innerText = data.terpakai;
            document.getElementById("rSisa").innerText = data.sisa;
            document.getElementById("rSakit").innerText = data.sakit;
          } else {
            alert("ID Tidak Ditemukan!");
          }
        }).searchUser(id);
      }
    </script>
  </body>
</html>